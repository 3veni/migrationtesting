<?xml version="1.0" encoding="UTF-8"?>
<HomePageComponent xmlns="http://soap.sforce.com/2006/04/metadata">
    <body>&lt;script src=&quot;/soap/ajax/15.0/connection.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/soap/ajax/15.0/apex.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;        var refreshInterval=0;        var intervalID=0;        function refreshButton(style)        {	  var theBtn=document.getElementById(&apos;theBtn&apos;);	  if(theBtn)	    theBtn.style.display=style;	          }        function getCookie(c_name)        {            var i,x,y,ARRcookies=document.cookie.split(&quot;;&quot;);            for (i=0;i&lt;ARRcookies.length;i++)            {                x=ARRcookies[i].substr(0,ARRcookies[i].indexOf(&quot;=&quot;));                y=ARRcookies[i].substr(ARRcookies[i].indexOf(&quot;=&quot;)+1);                x=x.replace(/^\s+|\s+$/g,&quot;&quot;);                if (x==c_name)                {                   return unescape(y);                }            }        }       function setCookie(c_name,value,exdays)       {           var exdate=new Date();           exdate.setDate(exdate.getDate() + exdays);           var c_value=escape(value) + ((exdays==null) ? &quot;&quot; : &quot;; expires=&quot;+exdate.toUTCString());           document.cookie=c_name + &quot;=&quot; + c_value;        }        function decode(json)        {            return window.JSON &amp;&amp; window.JSON.parse ? window.JSON.parse(json) : (new Function(&quot;return &quot; + json))();        }        function refreshThePage ( )        {             var ctrlMap={                              thePage:document.getElementById(&apos;thePage&apos;),                              theCount:document.getElementById(&apos;theCount&apos;),                              new_ctrl:document.getElementById(&apos;new_ctrl&apos;),                              delivered_ctrl:document.getElementById(&apos;delivered_ctrl&apos;),                              failed_ctrl:document.getElementById(&apos;failed_ctrl&apos;),                              received_ctrl:document.getElementById(&apos;received_ctrl&apos;),                              error_ctrl:document.getElementById(&apos;error_ctrl&apos;)                          };             ctrlMap.new_ctrl.innerHTML=&apos;-&apos;;             ctrlMap.delivered_ctrl.innerHTML=&apos;-&apos;;             ctrlMap.failed_ctrl.innerHTML=&apos;-&apos;;             ctrlMap.received_ctrl.innerHTML=&apos;-&apos;;             ctrlMap.error_ctrl.style.display=&quot;none&quot;;             try             {                var sid=getCookie(&apos;sid_sidebar&apos;);                if(sid==undefined || sid==null || sid==&apos;&apos;)                   sid=getCookie(&apos;sid&apos;);                sforce.connection.init(sid,&quot;services/Soap/u/25.0&quot;);                var str=sforce.apex.execute(&quot;TOA.ETAworkforceSideBarController&quot;, &quot;getNotiticationsCountStructure&quot;, {});                var countStructure=decode(str);                if(console)console.log(&quot;refresh &quot;+countStructure.refreshInterval);                if(refreshInterval==0)                {                   if(countStructure)                   {		    refreshInterval=countStructure.refreshInterval;		    		    /*if(refreshInterval==0)		      refreshButton(&apos;&apos;);		    else		     refreshButton(&apos;none&apos;);*/		   }		   else		   {		    refreshInterval=2*60*1000;		   }                }                                if(intervalID==0 &amp;&amp; refreshInterval!=0)		  intervalID=setInterval(refreshThePage,refreshInterval);                if(countStructure==undefined)		  return;		if(countStructure!=null &amp;&amp; countStructure.status==&apos;disabled&apos;)                {                  disableRefresh();                  return;                }                var countMap={};                for(i in countStructure.counts)                {                  countMap[countStructure.counts[i].status]=countStructure.counts[i].quantity;                  var ctrl=ctrlMap[countStructure.counts[i].status+&apos;_ctrl&apos;];                  if(ctrl)                    ctrl.innerHTML=countStructure.counts[i].quantity;                }                ctrlMap.thePage.style.display=(countMap[&apos;false&apos;]&gt;0?&quot;&quot;:&quot;none&quot;); ctrlMap.theCount.innerHTML=countMap[&apos;false&apos;];             }             catch(ex)             {                ctrlMap.error_ctrl.innerHTML=ex.toString();                ctrlMap.error_ctrl.style.display=&quot;&quot;;             }        };        function disableRefresh()        {                if(intervalID!=0){clearInterval(intervalID);intervalID=0;}        }        function startRefresh()        {                setTimeout(&apos;refreshThePage();&apos;,100);        };        startRefresh();        window.onblur=&apos;disableRefresh();&apos;;        window.onfocus=&apos;refreshThePage();&apos;;&lt;/script&gt;&lt;div id=&quot;thePage&quot; style=&quot;display: none;&quot;&gt;&lt;span class=&quot;btnImportant&quot; style=&quot;height: 100%; display: block; text-align: center;vertical-align:middle;&quot; onclick=&quot;window.location.href=&apos;/apex/TOA__ETAworkforceNotificationsPage?unread=true&apos;&quot;&gt;You have &lt;span id=&quot;theCount&quot;&gt;???&lt;/span&gt; unread message(s)...&lt;/span&gt;&lt;/div&gt;&lt;table width=&quot;100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td width=&quot;30%&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceNotificationsPage?status=new&quot; target=&quot;_Notifications&quot; style=&quot;text-decoration:none;color=blue&quot;&gt;&lt;font color=&quot;blue&quot;&gt;New&lt;/font&gt;&lt;/a&gt;&lt;/td&gt;&lt;td id=&quot;new_ctrl&quot;&gt;-&lt;/td&gt;&lt;td width=&quot;40%&quot;&gt;&lt;/td&gt;&lt;td width:&quot;30%&quot;=&quot;&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceNotificationsPage?status=delivered&quot; target=&quot;_Notifications&quot; style=&quot;text-decoration:none&quot;&gt;&lt;font color=&quot;blue&quot;&gt;Delivered&lt;/font&gt;&lt;/a&gt;&lt;/td&gt;&lt;td id=&quot;delivered_ctrl&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width=&quot;30%&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceNotificationsPage?status=failed&quot; target=&quot;_Notifications&quot; style=&quot;text-decoration:none&quot;&gt;&lt;font color=&quot;red&quot;&gt;Failed&lt;/font&gt;&lt;/a&gt;&lt;/td&gt;&lt;td id=&quot;failed_ctrl&quot;&gt;-&lt;/td&gt;&lt;td width=&quot;40%&quot;&gt;&lt;/td&gt;&lt;td width:&quot;30%&quot;=&quot;&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceNotificationsPage?status=received&quot; target=&quot;_Notifications&quot; style=&quot;text-decoration:none&quot;&gt;&lt;font color=&quot;green&quot;&gt;Received&lt;/font&gt;&lt;/a&gt;&lt;/td&gt;&lt;td id=&quot;received_ctrl&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width=&quot;30%&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceSettingsPage&quot; target=&quot;_blank&quot;&gt;Settings&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td width=&quot;40%&quot;&gt;&lt;/td&gt;&lt;td width:&quot;30%&quot;=&quot;&quot;&gt;&lt;a href=&quot;/apex/TOA__ETAworkforceNotificationsPage&quot; target=&quot;_Notifications&quot;&gt;Notifications&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;theBtn&quot; colspan=&quot;5&quot; style=&quot;text-align: center&quot;&gt;&lt;span class=&quot;btnImportant&quot; style=&quot;height: 100%; display: block; text-align: center;vertical-align:middle;padding-top:5pt;padding-bottom:5pt;&quot; onclick=&quot;refreshThePage();&quot;&gt;Refresh&lt;/span&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;error_ctrl&quot; colspan=&quot;5&quot; style=&quot;display:none;font-size: 8px; color:red;text-align: center&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</body>
    <pageComponentType>htmlArea</pageComponentType>
    <width>narrow</width>
</HomePageComponent>
